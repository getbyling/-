大型企业代码上线发布架构方案
============================

大型企业代码上线发布架构方案建议：
---------------------------------
>1、本地开发人员从服务器取代码，当天上线的提交到master。否则，长期项目单开分支开发，然后再合并到develop，测试通过后合并master上线。

>2、办公内网开发测试时，由开发人员或配置管理员通过部署平台```jenkins```实现统一部署，（即在部署平台上控制开发机器从服务器取代码，编译，打包，发布到开发机，包名如****.war）。

>3、开发人员通知或和测试人员一起测试程序，没有问题后，由配置管理员找上新的 tag 标记。

>4、配置管理员，根据上步的 tag 标记。 Checkout 出上线代码，并配置好 IDC 测试环境的所有配置，执行编译，打包（mvn，ant）（php 不需要），然后发布到 IDC 内的统一分发服务器。这里要注意：**不同的环境的配置文件是随代码同时发布的**。

>5、配置管理员或SA上线人员，把分发的程序代码内容推送到相关测试服务器（包名如：***.war），然后通知开发及测试人员进行测试。如果有问题向上回退，继续修改。

>6、如果 IDC 测试没有问题，继续打好 tag 标记。此时，配置管理员，根据上步的 tag 标记。 Checkout 出测试好的代码，并配置好 IDC 正式环境的所有配置，执行编译，打包（mvn，ant）（php 不需要），然后发布到 IDC 内的统一分发服务器主机，准备批量分布。

>7、配置管理员或SA上线人员，把分发的内容推送到相关正式服务器（包名如：***.war），然后通知开发及测试人员进行测试。如果有问题直接发布回滚指令。

>IDC 正式上线的过程对于 JAVA 程序，可以是 AB 组分组上线的思路。即平滑下线一半的服务器，然后发布更新代码，再重启测试。无问题后，挂上更新后的服务器，同时再平滑下线另一半服务器，接着发布更新代码测试（或直接发布后，重启，挂上）。
